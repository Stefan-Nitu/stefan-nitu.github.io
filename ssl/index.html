<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TLS/SSL Security Explained</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="mobile-responsive.css">
</head>
<body>
    <div class="container">
        <h1>üîê TLS/SSL Security Explained</h1>

        <!-- Simplified TLS Explanation -->
        <div class="demo-section">
            <h2>1. How Secure Connections Work</h2>
            <div class="controls">
                <button id="tls-simple-play">‚ñ∂Ô∏è Play Animation</button>
                <button id="tls-simple-step">‚è≠Ô∏è Next Step</button>
                <button id="tls-simple-reset">üîÑ Reset</button>
            </div>

            <div class="stage" id="tls-simple-stage">
                <div class="step-indicator" id="tls-simple-status">
                    Simple explanation of how TLS keeps your data safe
                </div>

                <div class="entity client">
                    <div class="entity-icon">üì±</div>
                    <div class="entity-label">iOS App</div>
                    <div class="key-pair-visual" id="simple-client-cert" style="display:none;">
                        <div class="key-pair-label" style="color: #00ff88;">Has Received:</div>
                        <div class="key-pair-items">
                            <div class="key-item real-public-cert">
                                <span class="icon">üìú</span>
                                <span>SERVER CERT</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="entity server">
                    <div class="entity-icon">üñ•Ô∏è</div>
                    <div class="entity-label">Server</div>
                    <div class="key-pair-visual" id="simple-server-keys" style="display:none;">
                        <div class="key-pair-label" style="color: #00ffff;">Server Keys:</div>
                        <div class="key-pair-items">
                            <div class="key-item real-public-cert">
                                <span class="icon">üìú</span>
                                <span>PUBLIC CERT</span>
                            </div>
                            <div class="key-item real-private-key">
                                <span class="icon">üîë</span>
                                <span>PRIVATE KEY</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="entity ca">
                    <div class="entity-icon">üèõÔ∏è</div>
                    <div class="entity-label">iOS Trusted<br>CAs</div>
                </div>
            </div>

            <div class="description">
                Watch how your app creates a secure connection with a server
            </div>
        </div>

        <!-- MITM Attack -->
        <div class="demo-section">
            <h2>2. Man-in-the-Middle Attack</h2>
            <div class="controls">
                <button id="mitm-play">‚ñ∂Ô∏è Play Attack</button>
                <button id="mitm-step">‚è≠Ô∏è Next Step</button>
                <button id="mitm-reset">üîÑ Reset</button>
            </div>

            <div class="stage" id="mitm-stage">
                <div class="step-indicator" id="mitm-status">
                    See how attackers intercept "secure" connections
                </div>

                <div class="entity client" id="mitm-client">
                    <div class="entity-icon">üì±</div>
                    <div class="entity-label">iOS App</div>
                    <div class="key-pair-visual" id="mitm-client-cert" style="display:none;">
                        <div class="key-pair-label" style="color: #ff9999;">Received From Attacker:</div>
                        <div class="key-pair-items">
                            <div class="key-item fake-public-cert">
                                <span class="icon">üìú</span>
                                <span>FAKE CERT</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="entity attacker" id="mitm-attacker">
                    <div class="entity-icon">üëπ</div>
                    <div class="entity-label">ATTACKER</div>
                    <div class="key-pair-visual" id="attacker-keys" style="display:none;">
                        <div class="key-pair-label" style="color: #ff6666;">Attacker Keys:</div>
                        <div class="key-pair-items">
                            <div class="key-item fake-public-cert">
                                <span class="icon">üìú</span>
                                <span>FAKE CERT</span>
                            </div>
                            <div class="key-item fake-private-key">
                                <span class="icon">üîë</span>
                                <span>FAKE PRIVATE</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="entity server" id="mitm-server">
                    <div class="entity-icon">üñ•Ô∏è</div>
                    <div class="entity-label">Server</div>
                    <div class="key-pair-visual" id="mitm-server-keys" style="display:none;">
                        <div class="key-pair-label" style="color: #00ffff;">Server Keys:</div>
                        <div class="key-pair-items">
                            <div class="key-item real-public-cert">
                                <span class="icon">üìú</span>
                                <span>REAL CERT</span>
                            </div>
                            <div class="key-item real-private-key">
                                <span class="icon">üîë</span>
                                <span>REAL PRIVATE</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="description">
                The attacker has TWO certificates: a fake one for you, the real one with the server
            </div>
        </div>

        <!-- Certificate Pinning -->
        <div class="demo-section">
            <h2>3. Certificate Pinning Protection</h2>
            <div class="controls">
                <button id="pin-play">‚ñ∂Ô∏è Play Protection</button>
                <button id="pin-step">‚è≠Ô∏è Next Step</button>
                <button id="pin-reset">üîÑ Reset</button>
            </div>

            <div class="stage" id="pin-stage">
                <div class="step-indicator" id="pin-status">
                    Learn how apps protect against MITM by "pinning" the exact certificate
                </div>

                <div class="entity client" id="pin-client">
                    <div class="entity-icon">üì±</div>
                    <div class="entity-label">iOS App</div>
                    <div class="shield" id="pin-shield">üõ°Ô∏è</div>
                    <div class="key-pair-visual" id="pin-client-pinned" style="display:none;">
                        <div class="key-pair-label" style="color: #00ff88;">üìå Pinned:</div>
                        <div class="key-pair-items">
                            <div class="key-item real-public-cert">
                                <span class="icon">üìú</span>
                                <span>REAL CERT</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="entity attacker" id="pin-attacker">
                    <div class="entity-icon">üëπ</div>
                    <div class="entity-label">ATTACKER</div>
                    <div class="key-pair-visual" id="pin-attacker-keys" style="display:none;">
                        <div class="key-pair-label" style="color: #ff6666;">Attacker Keys:</div>
                        <div class="key-pair-items">
                            <div class="key-item fake-public-cert">
                                <span class="icon">üìú</span>
                                <span>FAKE CERT</span>
                            </div>
                            <div class="key-item fake-private-key">
                                <span class="icon">üîë</span>
                                <span>FAKE PRIVATE</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="entity server" id="pin-server">
                    <div class="entity-icon">üñ•Ô∏è</div>
                    <div class="entity-label">Server</div>
                    <div class="key-pair-visual" id="pin-server-keys" style="display:none;">
                        <div class="key-pair-label" style="color: #00ffff;">Server Keys:</div>
                        <div class="key-pair-items">
                            <div class="key-item real-public-cert">
                                <span class="icon">üìú</span>
                                <span>REAL CERT</span>
                            </div>
                            <div class="key-item real-private-key">
                                <span class="icon">üîë</span>
                                <span>REAL PRIVATE</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="description">
                The app has the server's certificate fingerprint hardcoded and rejects anything else
            </div>
        </div>

        <hr style="margin: 40px 0; border: 1px solid rgba(255,255,255,0.1);">
        <h2 style="text-align: center; color: #00ffff; margin-bottom: 30px;">üéì Advanced: Protocol Details</h2>

        <!-- TLS 1.3 Handshake -->
        <div class="demo-section">
            <h3>TLS 1.3 Modern Handshake (1-RTT)</h3>
            <div class="controls">
                <button id="tls13-play">‚ñ∂Ô∏è Play Animation</button>
                <button id="tls13-step">‚è≠Ô∏è Next Step</button>
                <button id="tls13-reset">üîÑ Reset</button>
            </div>

            <div class="stage" id="tls13-stage">
                <div class="step-indicator" id="tls13-status">
                    TLS 1.3 - Modern, fast, and secure handshake
                </div>

                <div class="entity client">
                    <div class="entity-icon">üì±</div>
                    <div class="entity-label">iOS App</div>
                </div>

                <div class="entity server">
                    <div class="entity-icon">üñ•Ô∏è</div>
                    <div class="entity-label">Server</div>
                </div>

                <div class="entity ca">
                    <div class="entity-icon">üèõÔ∏è</div>
                    <div class="entity-label">iOS Trusted<br>CAs</div>
                </div>
            </div>

            <div class="description">
                TLS 1.3: 1-RTT handshake, forward secrecy only, encrypted certificates, 0-RTT resumption
            </div>
        </div>

        <!-- TLS 1.2 Handshake -->
        <div class="demo-section">
            <h3>TLS 1.2 Classic Handshake (2-RTT)</h3>
            <div class="controls">
                <button id="tls12-play">‚ñ∂Ô∏è Play Animation</button>
                <button id="tls12-step">‚è≠Ô∏è Next Step</button>
                <button id="tls12-reset">üîÑ Reset</button>
            </div>

            <div class="stage" id="tls12-stage">
                <div class="step-indicator" id="tls12-status">
                    TLS 1.2 - Complete handshake process with all details
                </div>

                <div class="entity client">
                    <div class="entity-icon">üì±</div>
                    <div class="entity-label">iOS App</div>
                    <div class="key-pair-visual" id="tls12-client-cert" style="display:none;">
                        <div class="key-pair-label" style="color: #00ff88;">Has Received:</div>
                        <div class="key-pair-items">
                            <div class="key-item real-public-cert">
                                <span class="icon">üìú</span>
                                <span>SERVER CERT</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="entity server">
                    <div class="entity-icon">üñ•Ô∏è</div>
                    <div class="entity-label">Server</div>
                    <div class="key-pair-visual" id="tls12-server-keys" style="display:none;">
                        <div class="key-pair-label" style="color: #00ffff;">Server Keys:</div>
                        <div class="key-pair-items">
                            <div class="key-item real-public-cert">
                                <span class="icon">üìú</span>
                                <span>PUBLIC CERT</span>
                            </div>
                            <div class="key-item real-private-key">
                                <span class="icon">üîë</span>
                                <span>PRIVATE KEY</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="entity ca">
                    <div class="entity-icon">üèõÔ∏è</div>
                    <div class="entity-label">iOS Trusted<br>CAs</div>
                </div>
            </div>

            <div class="description">
                TLS 1.2: 2-RTT handshake, RSA or ECDHE key exchange, multiple cipher suites
            </div>
        </div>
    </div>

    <!-- Core animation framework -->
    <script src="shared.js"></script>
    <script src="declarative-animation.js"></script>

    <!-- Animation implementations -->
    <script src="tls-simplified-declarative.js"></script>
    <script src="mitm-declarative.js"></script>
    <script src="pinning-declarative.js"></script>
    <script src="tls13-handshake-declarative.js"></script>
    <script src="tls12-handshake-declarative.js"></script>

    <script>
        // Initialize all animations
        const tlsSimplified = new TLSSimplifiedAnimation();
        const mitmAttack = new MITMAnimation();
        const sslPinning = new SSLPinningAnimation();
        const tls13Handshake = new TLS13HandshakeAnimation();
        const tls12Handshake = new TLS12HandshakeAnimation();
    </script>
</body>
</html>